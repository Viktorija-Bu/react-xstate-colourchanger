(this["webpackJsonpxstate-react-typescript-template"]=this["webpackJsonpxstate-react-typescript-template"]||[]).push([[0],{29:function(e,t,o){},40:function(e,t,o){"use strict";o.r(t);var n=o(26),a=o(8),s=(o(29),o(7),o(23)),r=o(20),i=o(2),c=o(44),l=o(43);o(12).a.cancel;function p(e){return Object(i.q)((t=>({type:"SPEAK",value:e})))}let m=0;function y(e,t,o,n){return{initial:"prompt",states:{prompt:{entry:e,on:{ENDSPEECH:"ask"}},ask:{entry:[Object(i.q)("LISTEN"),Object(i.q)("MAXSPEECH",{delay:3500,id:"maxspeech2"})]},help:{entry:p(o),on:{ENDSPEECH:"prompt"}},nomatch:{entry:p(t),on:{ENDSPEECH:"prompt"}},maxspeech:{entry:p(n),on:{ENDSPEECH:[{cond:()=>3===m++,target:"prompt"},{target:"#machine"}]}}}}}const d={Donald:{person:"Donald Trump"},Joe:{person:"Joe Biden"},Barack:{person:"Barack Obama"},George:{person:"George W. Bush"},Bill:{person:"Bill Clinton"},"on Monday":{day:"Monday"},"on Tuesday":{day:"Tuesday"},"on Wednesday":{day:"Wednesday"},"on Thursday":{day:"Thursday"},"on Friday":{day:"Friday"},"on Saturday":{day:"Saturday"},"on Sunday":{day:"Sunday"},"at 7":{time:"7:00"},"at 8":{time:"8:00"},"at 9":{time:"9:00"},"at 10":{time:"10:00"},"at 11":{time:"11:00"},"at 12":{time:"12:00"},"at 1":{time:"13:00"},"at 2":{time:"14:00"},"at 3":{time:"15:00"},"at 4":{time:"16:00"},"at 5":{time:"17:00"},"at 6":{time:"18:00"}},u={yes:{yes:"yes"},"of course":{yes:"yes"},sure:{yes:"yes"},definitely:{yes:"yes"},yeah:{yes:"yes"},"most likely":{yes:"yes"},no:{no:"no"},"no way":{no:"no"},never:{no:"no"},"no for sure":{no:"no"},"I don't think so":{no:"no"},"not likely":{no:"no"}},h={id:"machine",initial:"start",states:{start:{on:{CLICK:"thing_to_do"}},thing_to_do:Object(a.a)({id:"choose",initial:"prompt",on:{RECOGNISED:[{actions:Object(i.b)((e=>({choice:e.recResult}))),target:"chosen_thing"},{target:".nomatch"}],MAXSPEECH:".maxspeech"}},y(p("What would you like to do?"),"Would you mind repeating?","Choose one of the three actions: appointment, to do list or timer","Please provide input")),chosen_thing:{invoke:{id:"RASA",src:(e,t)=>{return o=e.choice,fetch(new Request("https://cors-anywhere.herokuapp.com/https://viktorija-lab2.herokuapp.com/model/parse",{method:"POST",headers:{Origin:"http://maraev.me"},body:'{"text": "'.concat(o,'"}')})).then((e=>e.json()));var o},onDone:{target:"final",actions:[Object(i.b)(((e,t)=>({res:t.data.intent.name}))),(e,t)=>console.log(t.data)]},onError:{target:"thing_to_do",actions:(e,t)=>console.log(t.data)}}},final:{initial:"prompt",on:{ENDSPEECH:[{cond:e=>"Appointment"===e.res,target:"Appointment"},{cond:e=>"TODO_item"===e.res,target:"TODO_item"},{cond:e=>"Timer"===e.res,target:"Timer"},{target:".nomatch"}]},states:{prompt:{entry:Object(i.q)((e=>({type:"SPEAK",value:"Let me check"})))},nomatch:{entry:p("The task is unavailable"),on:{ENDSPEECH:"#choose"}}}},TODO_item:{initial:"prompt",on:{ENDSPEECH:"thing_to_do"},states:{prompt:{entry:p("Sorry, but this tool does not exist")}}},Timer:{initial:"prompt",on:{ENDSPEECH:"thing_to_do"},states:{prompt:{entry:p("Sorry, but this tool does not exist")}}},Appointment:{initial:"prompt",on:{ENDSPEECH:"who"},states:{prompt:{entry:p("Let's create an appointment")}}},who:Object(a.a)({initial:"prompt",on:{RECOGNISED:[{cond:e=>"person"in(d[e.recResult]||{}),actions:Object(i.b)((e=>({person:d[e.recResult].person}))),target:"day"},{cond:e=>"help"===e.recResult,target:".help"},{target:".nomatch"}],MAXSPEECH:".maxspeech"}},y(p("Who are you meeting with?"),"Sorry I don't know them","Name a person from your contact list whom you want to meet","Please repeat the input")),day:Object(a.a)({initial:"prompt",on:{RECOGNISED:[{cond:e=>"day"in(d[e.recResult]||{}),actions:Object(i.b)((e=>({day:d[e.recResult].day}))),target:"whole_day"},{cond:e=>"help"===e.recResult,target:".help"},{target:".nomatch"}],MAXSPEECH:".maxspeech"}},y(Object(i.q)((e=>({type:"SPEAK",value:"OK. ".concat(e.person,". On which day is your meeting?")}))),"Sorry I did not understand","Name a day when you want to meet your chosen person from the contact list","I cannot grasp the input, would you mind repeating?")),whole_day:Object(a.a)({initial:"prompt",on:{RECOGNISED:[{cond:e=>"yes"in(u[e.recResult]||{}),actions:Object(i.b)((e=>({yes:u[e.recResult].yes}))),target:"app"},{cond:e=>"no"in(u[e.recResult]||{}),actions:Object(i.b)((e=>({no:u[e.recResult].no}))),target:"time"},{target:".nomatch"}],MAXSPEECH:".maxspeech"}},y(p("Will it take the whole day?"),"Please repeat","You need to tell me whether you want to meet the person from morning to late afternoon","Looks like the input is unclear, please repeat")),app:Object(a.a)({initial:"prompt",on:{RECOGNISED:[{cond:e=>"yes"in(u[e.recResult]||{}),actions:Object(i.b)((e=>({yes:u[e.recResult].yes}))),target:"done"},{cond:e=>"no"in(u[e.recResult]||{}),actions:Object(i.b)((e=>({no:u[e.recResult].no}))),target:"who"},{target:".nomatch"}],MAXSPEECH:".maxspeech"}},y(Object(i.q)((e=>({type:"SPEAK",value:"Do you want me to create an appointment with ".concat(e.person," on ").concat(e.day," for the whole day?")}))),"Please repeat","Time to make a decision whether you want to meet your chosen person from morning to afternoon","Time to repeat the input")),done:{initial:"prompt",on:{ENDSPEECH:"start"},states:{prompt:{entry:Object(i.q)((e=>({type:"SPEAK",value:"Your appointment has been created!"})))}}},time:Object(a.a)({initial:"prompt",on:{RECOGNISED:[{cond:e=>"time"in(d[e.recResult]||{}),actions:Object(i.b)((e=>({time:d[e.recResult].time}))),target:"app2"},{target:".nomatch"}],MAXSPEECH:".maxspeech"}},y(Object(i.q)((e=>({type:"SPEAK",value:"".concat(e.day," it is. What time is your meeting?")}))),"Sorry could you repeat","Say hour for the meeting on your chosen day","Seems like I cannot grasp you, please say one more time")),app2:Object(a.a)({initial:"prompt",on:{RECOGNISED:[{cond:e=>"yes"in(u[e.recResult]||{}),actions:Object(i.b)((e=>({yes:u[e.recResult].yes}))),target:"done"},{cond:e=>"no"in(u[e.recResult]||{}),actions:Object(i.b)((e=>({no:u[e.recResult].no}))),target:"who"},{target:".nomatch"}],MAXSPEECH:".maxspeech"}},y(Object(i.q)((e=>({type:"SPEAK",value:"Do you want me to create an appointment with ".concat(e.person," on ").concat(e.day," at ").concat(e.time,"?")}))),"Please repeat","Time to make a decision comrade","Are you being silent? Repeat please"))}};var g=o(22),b=o(13);Object(l.a)({url:"https://statecharts.io/inspect",iframe:!1});const E=Object(r.a)({id:"root",type:"parallel",states:{dm:Object(a.a)({},h),asrtts:{initial:"idle",states:{idle:{on:{LISTEN:"recognising",SPEAK:{target:"speaking",actions:Object(i.b)(((e,t)=>({ttsAgenda:t.value})))}}},recognising:{entry:"recStart",exit:"recStop",on:{ASRRESULT:{actions:["recLogResult",Object(i.b)(((e,t)=>({recResult:t.value})))],target:".match"},RECOGNISED:"idle",MAXSPEECH:"idle"},states:{match:{entry:Object(i.q)("RECOGNISED")}}},speaking:{entry:"ttsStart",on:{ENDSPEECH:"idle"}}}}}},{actions:{recLogResult:e=>{console.log("<< ASR: "+e.recResult)},test:()=>{console.log("test")},logIntent:e=>{console.log("<< NLU intent: "+e.nluData.intent.name)}}}),O=e=>{switch(!0){case e.state.matches({asrtts:"recognising"}):return Object(b.jsx)("button",Object(a.a)(Object(a.a)({type:"button",className:"glow-on-hover",style:{animation:"glowing 20s linear"}},e),{},{children:"Listening..."}));case e.state.matches({asrtts:"speaking"}):return Object(b.jsx)("button",Object(a.a)(Object(a.a)({type:"button",className:"glow-on-hover",style:{animation:"bordering 1s infinite"}},e),{},{children:"Speaking..."}));default:return Object(b.jsx)("button",Object(a.a)(Object(a.a)({type:"button",className:"glow-on-hover"},e),{},{children:"Click to start"}))}};function S(){const e=Object(g.useSpeechSynthesis)({onEnd:()=>{m("ENDSPEECH")}}),t=e.speak,o=e.cancel,a=(e.speaking,Object(g.useSpeechRecognition)({onResult:e=>{m({type:"ASRRESULT",value:e})}})),s=a.listen,r=(a.listening,a.stop),i=Object(c.b)(E,{devTools:!0,actions:{recStart:Object(c.a)((()=>{console.log("Ready to receive a color command."),s({interimResults:!1,continuous:!0})})),recStop:Object(c.a)((()=>{console.log("Recognition stopped."),r()})),changeColour:Object(c.a)((e=>{console.log("Repainting..."),document.body.style.background=e.recResult})),ttsStart:Object(c.a)(((e,o)=>{console.log("Speaking..."),t({text:e.ttsAgenda})})),ttsCancel:Object(c.a)(((e,t)=>{console.log("TTS STOP..."),o()}))}}),l=Object(n.a)(i,3),p=l[0],m=l[1];l[2];return Object(b.jsx)("div",{className:"App",children:Object(b.jsx)(O,{state:p,onClick:()=>m("CLICK")})})}const j=document.getElementById("root");s.render(Object(b.jsx)(S,{}),j)}},[[40,1,2]]]);
//# sourceMappingURL=main.c9986759.chunk.js.map